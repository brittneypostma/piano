<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href= "./css/checkin.css">
        <link href="https://fonts.googleapis.com/css?family=Rouge+Script|Schoolbell" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.jquery.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.6.3/papaparse.min.js"></script>
        
        <script>
            Papa.parse("https://raw.githubusercontent.com/sballgirl11/sballgirl11.github.io/master/Waukazoo%20Volunteer%20List.csv", {
            	download: true,
                header: true,
            	complete: function(results) {
                    var volunteerSelect = document.getElementById('volunteersList');
                    var frag = document.createDocumentFragment();
                    results.data.forEach(function(row){
                        console.log(row);
                        elOption = frag.appendChild(document.createElement('option'));
                        elOption.text = row.firstname + " " + row.lastname;
                        volunteerSelect.appendChild(elOption);
                    });
            	}
            });
        </script>
 
        <script>
            function passWord() {
            var testV = 1;
            var pass1 = prompt('Please Enter Your Password',' ');
            while (testV < 3) {
            if (!pass1) 
            history.go(-1);
            if (pass1.toLowerCase() == "letmein") {
            window.open('https://docs.google.com/spreadsheets/d/13Mg3vM2jQj6JEfR1AHFcKV6NBIrSm4TnFr4tr-wSDFE/edit?usp=sharing', '_blank');
            break;
            } 
            testV+=1;
            var pass1 = 
            prompt('Access Denied - Password Incorrect, Please Try Again.','Password');
            }
            if (pass1.toLowerCase()!="password" & testV ==3) 
            history.go(-1);
            return " ";
            } </script>
        <title>Waukazoo Check In</title>
    </head>
    
<body>
         
    <header class="header">
   <h1 class="school">Waukazoo Elementary<br/>
      <span class="visitor">Visitor Check In</span></h1>
    </header> 

<main>
  
  <div class="checkInPage" id="formArea" style="text-align: center;">
    
    <div class="logoimg" style="text-align:center;">
      <img src="./imgs/logo.png" class="logo" alt="logo" style="width:300px; height:300px">
      <p class="date"><span id="date"></span><br/><span id="time"></span></p>
    </div>

  <form name="submit-to-google-sheet" action="" id="test-form" style="text-align: right;">
    <div>
      <h3 class="visit">VISITOR</h3>
    </div>
    <div class="chosen-container">
    <select class="chosen" name="Name" id="volunteersList">
      <option selected>Search for Your Name</option>
    </select>
    </div>

    <br/>

    <input required type="text" list="select" name="Location" id="class" placeholder="Pick location or type teacher's name here &#9660;" style="text-align: right;"/>
    <datalist class="location" id="select" onchange="onSelectChange()" name="Location">
      <option>---choose a location or type teacher's name---</option>
      <option value="Lunch Room"></option>
      <option value="Gymnasium"></option>
      <option value="Office"></option>
      <option value="Playground"></option>    
    </datalist>

    <br/>

    <textarea type="text" id="notes" name="Notes" placeholder="What will you be doing?" rows="4" style="text-align: right; resize: vertical;"></textarea>
 
    
    
  </form>

  </div>
  <button class="backButton" onclick="window.location.href = './index.html';">Back</button>
  <button form="test-form" type="submit" class="submit" id="postForm" onclick="window.location.reload()">Submit</button>
</main>   
    <footer>
                <div class="footer">
                   <aside class="left" style="text-align: left">
                   <button type="button" id="admin">
                      <a value="Enter Protected Area" onClick="passWord()">
                          <img src="./imgs/lock.png" alt="lock" style="width: 25px; height: 25px;">
                      </a>
                   </button>
                   </aside>
                   <aside class="center" style="text-align: center">
                       <img src="./imgs/wo.png" alt="west ottawa logo" style="width: 80px; height: 40px;">
                   </aside>
                   <aside class="right" style="text-align: right">
                       <button type="button" id="help">
                           <a href="help.html"><img src="./imgs/help.png" alt="help" style="width: 30px; height: 30px;"></a>
                       </button>
                   </aside>
               </div>
           
    
    
             
    </footer>

<script type="text/javascript">
$(".chosen").chosen();
</script>
<script>
 // get a new date (locale machine date time)
var date = new Date();
// get the date as a string
var n = date.toDateString();
// get the time as a string
var time = date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

// find the html element with the id of time
// set the innerHTML of that element to the date a space the time
document.getElementById('date').innerHTML = n ;
document.getElementById('time').innerHTML = time;
</script>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbzrKqVJEidj98LDaebjqwQX4Ti5tjvWcx52oLBrQwKqDH29_uo/exec'
  const form = document.forms['submit-to-google-sheet']

  form.addEventListener('submit', e => {
    e.preventDefault()
    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => console.log('Success!', response))
      .catch(error => console.error('Error!', error.message))
  })
</script>
</body>   
</html>
    
 
  
